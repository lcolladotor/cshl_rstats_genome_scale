[["index.html", "Statistical Analysis of Genome Scale Data 2023 Overview Code of Conduct Course Schedule External links Course Prerequisites R session information License", " Statistical Analysis of Genome Scale Data 2023 Leonardo Collado-Torres Overview Here you can find the files for the July 2023 Statistical Analysis of Genome Scale Data course at CSHL portion taught by Leo and his team (July 3rd to July 6th). Instructor: Leonardo Collado-Torres, Twitter Teach assistants: Daianna González Padilla, Twitter Fernanda Renee García Flores, Twitter Download the materials for this course with usethis::use_course('lcolladotor/cshl_rstats_genome_scale_2023') or view online at lcolladotor.github.io/cshl_rstats_genome_scale_2023. Code of Conduct We’ll follow the CSHL code of conduct as well as version 1.2.0 of the Bioconductor code of conduct bioconductor.github.io/bioc_coc_multilingual/. For reporting any violations of the code of conduct, report them to the Instructor and/or Course Coordinators. Course Schedule Local times in US Eastern Monday July 3rd Tuesday July 4th Wednesday July 5th Thursday July 6th External links CSHL course GitHub source code Slack. LieberInstitute/template_project Example real project (by Daianna): LieberInstitute/smokingMouse_Indirects SPEAQeasyWorkshop2023 for BioC2023 (by Daianna and Renee): LieberInstitute/SPEAQeasyWorkshop2023 Course Prerequisites Install R 4.3.x from CRAN then install the following R packages: ## For installing Bioconductor packages if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE)) { install.packages(&quot;BiocManager&quot;) } ## Install required packages BiocManager::install( c( &quot;usethis&quot;, ## Utilities &quot;BiocFileCache&quot;, &quot;RefManageR&quot;, &quot;here&quot;, &quot;biocthis&quot;, &quot;lobstr&quot;, &quot;postcards&quot;, &quot;sessioninfo&quot;, &quot;smokingMouse&quot;, &quot;SummarizedExperiment&quot;, ## Main containers / vis &quot;iSEE&quot;, &quot;edgeR&quot;, ## RNA-seq &quot;ExploreModelMatrix&quot;, &quot;limma&quot;, &quot;recount3&quot;, &quot;pheatmap&quot;, ## Visualization &quot;ggplot2&quot;, &quot;patchwork&quot;, &quot;RColorBrewer&quot;, &quot;ComplexHeatmap&quot;, &quot;spatialLIBD&quot; ## Advanced ) ) ## Install smokingMouse BiocManager::install(&quot;LieberInstitute/smokingMouse&quot;) You will also need to install RStudio version 2023.06.0+421 or newer. R session information Details on the R version used for making this book. The source code is available at lcolladotor/cshl_rstats_genome_scale_2023. ## Load the package at the top of your script library(&quot;sessioninfo&quot;) ## Utilities library(&quot;BiocFileCache&quot;) library(&quot;BiocStyle&quot;) library(&quot;biocthis&quot;) library(&quot;here&quot;) library(&quot;lobstr&quot;) library(&quot;postcards&quot;) library(&quot;usethis&quot;) library(&quot;sessioninfo&quot;) ## Data library(&quot;smokingMouse&quot;) ## Main containers / vis library(&quot;SummarizedExperiment&quot;) library(&quot;iSEE&quot;) ## RNA-seq library(&quot;edgeR&quot;) library(&quot;ExploreModelMatrix&quot;) library(&quot;limma&quot;) library(&quot;recount3&quot;) ## Visualization library(&quot;ComplexHeatmap&quot;) library(&quot;ggplot2&quot;) library(&quot;patchwork&quot;) library(&quot;pheatmap&quot;) library(&quot;RColorBrewer&quot;) ## Advanced library(&quot;spatialLIBD&quot;) ## Reproducibility information options(width = 120) session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.3.0 (2023-04-21) ## os Ubuntu 22.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2023-06-28 ## pandoc 2.19.2 @ /usr/local/bin/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## AnnotationDbi 1.62.1 2023-05-02 [1] Bioconductor ## AnnotationHub 3.8.0 2023-04-25 [1] Bioconductor ## attempt 0.3.1 2020-05-03 [1] RSPM (R 4.3.0) ## beachmat 2.16.0 2023-04-25 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.3.0) ## benchmarkme 1.0.8 2022-06-12 [1] RSPM (R 4.3.0) ## benchmarkmeData 1.0.4 2020-04-23 [1] RSPM (R 4.3.0) ## Biobase * 2.60.0 2023-04-25 [1] Bioconductor ## BiocFileCache * 2.8.0 2023-04-25 [1] Bioconductor ## BiocGenerics * 0.46.0 2023-04-25 [1] Bioconductor ## BiocIO 1.10.0 2023-04-25 [1] Bioconductor ## BiocManager 1.30.21 2023-06-10 [1] RSPM (R 4.3.0) ## BiocNeighbors 1.18.0 2023-04-25 [1] Bioconductor ## BiocParallel 1.34.2 2023-05-22 [1] Bioconductor ## BiocSingular 1.16.0 2023-04-25 [1] Bioconductor ## BiocStyle * 2.28.0 2023-04-25 [1] Bioconductor ## biocthis * 1.10.3 2023-06-07 [1] Bioconductor ## BiocVersion 3.17.1 2022-11-04 [2] Bioconductor ## Biostrings 2.68.1 2023-05-16 [1] Bioconductor ## bit 4.0.5 2022-11-15 [1] RSPM (R 4.3.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.3.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.3.0) ## blob 1.2.4 2023-03-17 [1] RSPM (R 4.3.0) ## bookdown 0.34 2023-05-09 [1] RSPM (R 4.3.0) ## bslib 0.5.0 2023-06-09 [2] RSPM (R 4.3.0) ## cachem 1.0.8 2023-05-01 [2] RSPM (R 4.3.0) ## circlize 0.4.15 2022-05-10 [1] RSPM (R 4.3.0) ## cli 3.6.1 2023-03-23 [2] RSPM (R 4.3.0) ## clue 0.3-64 2023-01-31 [1] RSPM (R 4.3.0) ## cluster 2.1.4 2022-08-22 [3] CRAN (R 4.3.0) ## codetools 0.2-19 2023-02-01 [3] CRAN (R 4.3.0) ## colorspace 2.1-0 2023-01-23 [1] RSPM (R 4.3.0) ## colourpicker 1.2.0 2022-10-28 [1] RSPM (R 4.3.0) ## ComplexHeatmap * 2.16.0 2023-04-25 [1] Bioconductor ## config 0.3.1 2020-12-17 [1] RSPM (R 4.3.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.3.0) ## crayon 1.5.2 2022-09-29 [2] RSPM (R 4.3.0) ## curl 5.0.1 2023-06-07 [2] RSPM (R 4.3.0) ## data.table 1.14.8 2023-02-17 [1] RSPM (R 4.3.0) ## DBI 1.1.3 2022-06-18 [1] RSPM (R 4.3.0) ## dbplyr * 2.3.2 2023-03-21 [1] RSPM (R 4.3.0) ## DelayedArray 0.26.3 2023-05-22 [1] Bioconductor ## DelayedMatrixStats 1.22.1 2023-06-09 [1] Bioconductor ## digest 0.6.32 2023-06-26 [2] RSPM (R 4.3.0) ## doParallel 1.0.17 2022-02-07 [1] RSPM (R 4.3.0) ## dotCall64 1.0-2 2022-10-03 [1] RSPM (R 4.3.0) ## dplyr 1.1.2 2023-04-20 [1] RSPM (R 4.3.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.3.0) ## DropletUtils 1.20.0 2023-04-25 [1] Bioconductor ## DT 0.28 2023-05-18 [1] RSPM (R 4.3.0) ## edgeR * 3.42.4 2023-05-31 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.3.0) ## evaluate 0.21 2023-05-05 [2] RSPM (R 4.3.0) ## ExperimentHub 2.8.0 2023-04-25 [1] Bioconductor ## ExploreModelMatrix * 1.12.0 2023-04-25 [1] Bioconductor ## fansi 1.0.4 2023-01-22 [2] RSPM (R 4.3.0) ## fastmap 1.1.1 2023-02-24 [2] RSPM (R 4.3.0) ## fields 14.1 2022-08-12 [1] RSPM (R 4.3.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.3.0) ## foreach 1.5.2 2022-02-02 [1] RSPM (R 4.3.0) ## fs 1.6.2 2023-04-25 [2] RSPM (R 4.3.0) ## generics 0.1.3 2022-07-05 [1] RSPM (R 4.3.0) ## GenomeInfoDb * 1.36.1 2023-06-21 [1] Bioconductor ## GenomeInfoDbData 1.2.10 2023-05-17 [1] Bioconductor ## GenomicAlignments 1.36.0 2023-04-25 [1] Bioconductor ## GenomicRanges * 1.52.0 2023-04-25 [1] Bioconductor ## GetoptLong 1.0.5 2020-12-15 [1] RSPM (R 4.3.0) ## ggbeeswarm 0.7.2 2023-04-29 [1] RSPM (R 4.3.0) ## ggplot2 * 3.4.2 2023-04-03 [1] RSPM (R 4.3.0) ## ggrepel 0.9.3 2023-02-03 [1] RSPM (R 4.3.0) ## GlobalOptions 0.1.2 2020-06-10 [1] RSPM (R 4.3.0) ## glue 1.6.2 2022-02-24 [2] RSPM (R 4.3.0) ## golem 0.4.1 2023-06-05 [1] RSPM (R 4.3.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.3.0) ## gtable 0.3.3 2023-03-21 [1] RSPM (R 4.3.0) ## HDF5Array 1.28.1 2023-05-01 [1] Bioconductor ## here * 1.0.1 2020-12-13 [1] RSPM (R 4.3.0) ## htmltools 0.5.5 2023-03-23 [2] RSPM (R 4.3.0) ## htmlwidgets 1.6.2 2023-03-17 [2] RSPM (R 4.3.0) ## httpuv 1.6.11 2023-05-11 [2] RSPM (R 4.3.0) ## httr 1.4.6 2023-05-08 [2] RSPM (R 4.3.0) ## igraph 1.5.0 2023-06-16 [1] RSPM (R 4.3.0) ## interactiveDisplayBase 1.38.0 2023-04-25 [1] Bioconductor ## IRanges * 2.34.1 2023-06-22 [1] Bioconductor ## irlba 2.3.5.1 2022-10-03 [1] RSPM (R 4.3.0) ## iSEE * 2.12.0 2023-04-25 [1] Bioconductor ## iterators 1.0.14 2022-02-05 [1] RSPM (R 4.3.0) ## jquerylib 0.1.4 2021-04-26 [2] RSPM (R 4.3.0) ## jsonlite 1.8.5 2023-06-05 [2] RSPM (R 4.3.0) ## KEGGREST 1.40.0 2023-04-25 [1] Bioconductor ## knitr 1.43 2023-05-25 [2] RSPM (R 4.3.0) ## later 1.3.1 2023-05-02 [2] RSPM (R 4.3.0) ## lattice 0.21-8 2023-04-05 [3] CRAN (R 4.3.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.3.0) ## lifecycle 1.0.3 2022-10-07 [2] RSPM (R 4.3.0) ## limma * 3.56.2 2023-06-04 [1] Bioconductor ## lobstr * 1.1.2 2022-06-22 [1] RSPM (R 4.3.0) ## locfit 1.5-9.8 2023-06-11 [1] RSPM (R 4.3.0) ## magick 2.7.4 2023-03-09 [1] RSPM (R 4.3.0) ## magrittr 2.0.3 2022-03-30 [2] RSPM (R 4.3.0) ## maps 3.4.1 2022-10-30 [1] RSPM (R 4.3.0) ## MASS 7.3-60 2023-05-04 [3] RSPM (R 4.3.0) ## Matrix 1.5-4.1 2023-05-18 [3] RSPM (R 4.3.0) ## MatrixGenerics * 1.12.2 2023-06-09 [1] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [1] RSPM (R 4.3.0) ## memoise 2.0.1 2021-11-26 [2] RSPM (R 4.3.0) ## mgcv 1.8-42 2023-03-02 [3] CRAN (R 4.3.0) ## mime 0.12 2021-09-28 [2] RSPM (R 4.3.0) ## miniUI 0.1.1.1 2018-05-18 [2] RSPM (R 4.3.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.3.0) ## nlme 3.1-162 2023-01-31 [3] CRAN (R 4.3.0) ## paletteer 1.5.0 2022-10-19 [1] RSPM (R 4.3.0) ## patchwork * 1.1.2 2022-08-19 [1] RSPM (R 4.3.0) ## pheatmap * 1.0.12 2019-01-04 [1] RSPM (R 4.3.0) ## pillar 1.9.0 2023-03-22 [2] RSPM (R 4.3.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.3.0) ## plotly 4.10.2 2023-06-03 [1] RSPM (R 4.3.0) ## png 0.1-8 2022-11-29 [1] RSPM (R 4.3.0) ## postcards * 0.2.3 2022-01-07 [1] RSPM (R 4.3.0) ## promises 1.2.0.1 2021-02-11 [2] RSPM (R 4.3.0) ## purrr 1.0.1 2023-01-10 [2] RSPM (R 4.3.0) ## R.cache 0.16.0 2022-07-21 [1] RSPM (R 4.3.0) ## R.methodsS3 1.8.2 2022-06-13 [1] RSPM (R 4.3.0) ## R.oo 1.25.0 2022-06-12 [1] RSPM (R 4.3.0) ## R.utils 2.12.2 2022-11-11 [1] RSPM (R 4.3.0) ## R6 2.5.1 2021-08-19 [2] RSPM (R 4.3.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.3.0) ## RColorBrewer * 1.1-3 2022-04-03 [1] RSPM (R 4.3.0) ## Rcpp 1.0.10 2023-01-22 [2] RSPM (R 4.3.0) ## RCurl 1.98-1.12 2023-03-27 [1] RSPM (R 4.3.0) ## recount3 * 1.10.2 2023-05-07 [1] Bioconductor ## rematch2 2.1.2 2020-05-01 [2] RSPM (R 4.3.0) ## restfulr 0.0.15 2022-06-16 [1] RSPM (R 4.3.0) ## rhdf5 2.44.0 2023-04-25 [1] Bioconductor ## rhdf5filters 1.12.1 2023-04-30 [1] Bioconductor ## Rhdf5lib 1.22.0 2023-04-25 [1] Bioconductor ## rintrojs 0.3.2 2022-08-09 [1] RSPM (R 4.3.0) ## rjson 0.2.21 2022-01-09 [1] RSPM (R 4.3.0) ## rlang 1.1.1 2023-04-28 [2] RSPM (R 4.3.0) ## rmarkdown 2.22 2023-06-01 [2] RSPM (R 4.3.0) ## rprojroot 2.0.3 2022-04-02 [2] RSPM (R 4.3.0) ## Rsamtools 2.16.0 2023-04-25 [1] Bioconductor ## RSQLite 2.3.1 2023-04-03 [1] RSPM (R 4.3.0) ## rstudioapi 0.14 2022-08-22 [2] RSPM (R 4.3.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.3.0) ## rtracklayer 1.60.0 2023-04-25 [1] Bioconductor ## S4Arrays 1.0.4 2023-05-14 [1] Bioconductor ## S4Vectors * 0.38.1 2023-05-02 [1] Bioconductor ## sass 0.4.6 2023-05-03 [2] RSPM (R 4.3.0) ## ScaledMatrix 1.8.1 2023-05-03 [1] Bioconductor ## scales 1.2.1 2022-08-20 [1] RSPM (R 4.3.0) ## scater 1.28.0 2023-04-25 [1] Bioconductor ## scuttle 1.10.1 2023-05-02 [1] Bioconductor ## sessioninfo * 1.2.2 2021-12-06 [2] RSPM (R 4.3.0) ## shape 1.4.6 2021-05-19 [1] RSPM (R 4.3.0) ## shiny 1.7.4 2022-12-15 [2] RSPM (R 4.3.0) ## shinyAce 0.4.2 2022-05-06 [1] RSPM (R 4.3.0) ## shinydashboard 0.7.2 2021-09-30 [1] RSPM (R 4.3.0) ## shinyjs 2.1.0 2021-12-23 [1] RSPM (R 4.3.0) ## shinyWidgets 0.7.6 2023-01-08 [1] RSPM (R 4.3.0) ## SingleCellExperiment * 1.22.0 2023-04-25 [1] Bioconductor ## smokingMouse * 0.99.5 2023-06-28 [1] Github (LieberInstitute/smokingMouse@2e7640c) ## spam 2.9-1 2022-08-07 [1] RSPM (R 4.3.0) ## sparseMatrixStats 1.12.1 2023-06-20 [1] Bioconductor ## SpatialExperiment * 1.10.0 2023-04-25 [1] Bioconductor ## spatialLIBD * 1.12.0 2023-04-27 [1] Bioconductor ## statmod 1.5.0 2023-01-06 [1] RSPM (R 4.3.0) ## styler 1.10.1 2023-06-05 [1] RSPM (R 4.3.0) ## SummarizedExperiment * 1.30.2 2023-06-06 [1] Bioconductor ## tibble 3.2.1 2023-03-20 [2] RSPM (R 4.3.0) ## tidyr 1.3.0 2023-01-24 [1] RSPM (R 4.3.0) ## tidyselect 1.2.0 2022-10-10 [1] RSPM (R 4.3.0) ## usethis * 2.2.1 2023-06-23 [2] RSPM (R 4.3.0) ## utf8 1.2.3 2023-01-31 [2] RSPM (R 4.3.0) ## vctrs 0.6.3 2023-06-14 [2] RSPM (R 4.3.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.3.0) ## viridis 0.6.3 2023-05-03 [1] RSPM (R 4.3.0) ## viridisLite 0.4.2 2023-05-02 [1] RSPM (R 4.3.0) ## withr 2.5.0 2022-03-03 [2] RSPM (R 4.3.0) ## xfun 0.39 2023-04-20 [2] RSPM (R 4.3.0) ## XML 3.99-0.14 2023-03-19 [1] RSPM (R 4.3.0) ## xtable 1.8-4 2019-04-21 [2] RSPM (R 4.3.0) ## XVector 0.40.0 2023-04-25 [1] Bioconductor ## yaml 2.3.7 2023-01-23 [2] RSPM (R 4.3.0) ## zlibbioc 1.46.0 2023-04-25 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── proc.time() ## user system elapsed ## 13.399 0.660 13.998 This book was last updated at 2023-06-28 02:05:06.017962. License This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],["speaqeasy-introduction.html", "1 SPEAQeasy introduction", " 1 SPEAQeasy introduction Instructor: Leo "],["smokingmouse-study.html", "2 smokingMouse study 2.1 Introduction 2.2 Overview 2.3 Goals 2.4 Study design", " 2 smokingMouse study Instructor: Daianna As part of your training, we’ll guide you through an analysis with real bulk RNA-seq data. The dataset that we’ll be using is a RangedSummarizedExperiment coming from the smokingMouse (Gonzalez-Padilla and Collado-Torres, 2023) package, but in this chapter we’ll explain you the study design and the experimental stages that preceded the data generation. The smoking mouse study is a project currently being developed at the Lieber Institute for Brain Development by Daianna Gonzalez-Padilla and Leonardo Collado-Torres. 2.1 Introduction Nowadays, maternal smoking during pregnancy (MSDP) is one of the major health concerns worldwide not only because of the effects on the smoker but because the health of the offspring could be dramatically affected by smoking exposure, particularly their cognitive and behavioral traits. But are those effects caused by cigarette smoke only? Or are those alterations given by a specific component of cigarettes such as nicotine? The latter is a very relevant question because most of the studies have focused on analyzing smoking effects, ignoring the role of nicotine, an active component of the cigarettes. Understanding which effects are specifically dictated by nicotine prenatal exposure will enable more directed studies of this drug on the developing brain, once affected genes have been identified and experimentally proven. 2.2 Overview This study consisted of a series of bulk RNA-sequencing experiments performed on brain samples from adult mice and pups and on blood samples from adults. Adult mice were either exposed to cigarette smoke (what we call smoking experiment and smoking mice) or controls of the smoking experiment, or they were administered nicotine (nicotine experiment and nicotine mice) or controls of the nicotine experiment, and they were either pregnant or not. Smoking, nicotine and control pups are pups that were born to smoking, nicotine and control pregnant mice, respectively. This experimental design allowed us to contrast the altered features in both conditions and to compare the effects in different mouse ages, sexes, tissues and pregnancy states. The original datasets contain gene, transcript, exon and junction expression levels across 208 samples, but in this course we’ll only use gene data in nicotine samples to simplify the analyses. 2.3 Goals This project actually aimed to answer 4 questions, all related to smoking and nicotine effects in mouse. 2.3.1 Main objective The main goal was to identify and differentiate the effects of prenatal nicotine and smoking exposures on gene, transcript, exon and junction expression of developing brain of pups. Basically, to perform a differential expression analysis on mouse data to find significant feature expression changes. 2.3.2 Secondary objectives To evaluate the affected genes by each substance on adult brain in order to compare pup and adult results. To examine the effects of smoking on adult blood and brain to search for overlapping biomarkers in both tissues (Can blood analyses capture environmental effects on brain?) To compare mouse differentially expressed genes (DEGs) with results from previous studies in human (Semick, S.A. et al. (2018) and Toikumo, S. et al. (2023)). Check here for the code of the original and complete analyses done. 2.4 Study design As presented in Figure 1: A), 36 pregnant dams and 35 non-pregnant female adult mice were either administered nicotine by intraperitoneal injection (IP; n=12), exposed to cigarette smoke in smoking chambers (n=24), or controls (n=35; 11 nicotine controls and 24 smoking controls). A total of 137 pups were born to pregnant dams: 19 were born to mice that were administered nicotine, 46 to mice exposed to cigarette smoke and the remaining 72 to control mice (23 to nicotine controls and 49 to smoking controls). Samples from frontal cortices of P0 pups and adults were obtained, as well as blood samples from smoking-exposed and smoking control adults. Then, as shown in B) RNA was extracted from all those samples and RNA-seq libraries were prepared and sequenced to obtain expression counts for genes, exons, transcripts and exon-exon junctions. Figure 1: Experimental design of the study. "],["summarizedexperiment-review.html", "3 SummarizedExperiment review", " 3 SummarizedExperiment review Instructor: Renee "],["smokingmouse-rse.html", "4 smokingMouse RSE 4.1 Download data 4.2 Data overview", " 4 smokingMouse RSE Instructor: Daianna Once you have reviewed how to use RangedSummarizedExperiment (RSE) objects in R, now we’ll start exploring the smokingMouse data. As previously described, the smoking mouse project is a complex study with more than 200 samples from brain and blood, adult mice and pups, pregnant and not pregnant mice, etc. The whole datasets of this project can be downloaded from the (Gonzalez-Padilla and Collado-Torres, 2023) package. Visit here for more details. 4.1 Download data For illustrative purposes, we’ll use nicotine data at the gene level which reside in a RangedSummarizedExperiment (RSE) object called rse_gene. We’ll use BiocFileCache to keep the data in a local cache in case we want to run this example again and don’t want to re-download the data from the web. ## Download and cache the file library(&quot;BiocFileCache&quot;) bfc &lt;- BiocFileCache::BiocFileCache() cached_rse_gene &lt;- BiocFileCache::bfcrpath( x = bfc, &quot;https://github.com/LieberInstitute/SPEAQeasyWorkshop2023/raw/devel/provisional_data/rse_gene_mouse_RNAseq_nic-smo.Rdata&quot; ) #&gt; adding rname &#39;https://github.com/LieberInstitute/SPEAQeasyWorkshop2023/raw/devel/provisional_data/rse_gene_mouse_RNAseq_nic-smo.Rdata&#39; ## Check the local path on our cache cached_rse_gene #&gt; BFC1 #&gt; &quot;/github/home/.cache/R/BiocFileCache/4c43245269d_rse_gene_mouse_RNAseq_nic-smo.Rdata&quot; ## Load the rse_gene object load(cached_rse_gene, verbose = TRUE) #&gt; Loading objects: #&gt; rse_gene ## General overview of the object rse_gene #&gt; class: RangedSummarizedExperiment #&gt; dim: 55401 208 #&gt; metadata(1): Obtained_from #&gt; assays(2): counts logcounts #&gt; rownames(55401): ENSMUSG00000102693.1 ENSMUSG00000064842.1 ... ENSMUSG00000064371.1 ENSMUSG00000064372.1 #&gt; rowData names(13): Length gencodeID ... DE_in_pup_brain_nicotine DE_in_pup_brain_smoking #&gt; colnames: NULL #&gt; colData names(71): SAMPLE_ID FQCbasicStats ... retained_after_QC_sample_filtering #&gt; retained_after_manual_sample_filtering 4.2 Data overview 4.2.1 Assays The dataset rse_gene contains the following assays: counts: original read counts of the 55,401 mouse genes across 208 samples (inlcuding the 65 nicotine samples of interest). logcounts: normalized and scaled counts (\\(log_2(CPM + 0.5)\\)) of the same genes across the same samples; normalization was carried out applying TMM method with cpm(calcNormFactors()) of edgeR. ## Explore main assay (of raw counts) assay(rse_gene)[1:3, 1:3] ## counts for first 3 genes and 3 samples #&gt; [,1] [,2] [,3] #&gt; ENSMUSG00000102693.1 0 0 0 #&gt; ENSMUSG00000064842.1 0 0 0 #&gt; ENSMUSG00000051951.5 811 710 812 ## Access the same raw data with assays() assays(rse_gene)$counts[1:3, 1:3] #&gt; [,1] [,2] [,3] #&gt; ENSMUSG00000102693.1 0 0 0 #&gt; ENSMUSG00000064842.1 0 0 0 #&gt; ENSMUSG00000051951.5 811 710 812 ## Access lognorm counts assays(rse_gene)$logcounts[1:3, 1:3] #&gt; [,1] [,2] [,3] #&gt; ENSMUSG00000102693.1 -5.985331 -5.985331 -5.985331 #&gt; ENSMUSG00000064842.1 -5.985331 -5.985331 -5.985331 #&gt; ENSMUSG00000051951.5 4.509114 4.865612 4.944597 4.2.2 Sample data The same RSE contains the sample information in colData(RSE). Yellow variables correspond to SPEAQeasy outputs that are going to be used in downstream analyses. Pink variables are specific of the study, such as sample metadata and some others containing additional information of the genes. Blue variables are Quality-Control metrics computed by addPerCellQC() of scuttle. colData(RSE) contains the following sample variables: SAMPLE_ID : is the name of the sample. ERCCsumLogErr : a summary statistic quantifying overall difference of expected and actual ERCC concentrations for one sample. overallMapRate : the decimal fraction of reads which successfully mapped to the reference genome (i.e. numMapped / numReads). mitoMapped : the number of reads which successfully mapped to the mitochondrial chromosome. totalMapped : the number of reads which successfully mapped to the canonical sequences in the reference genome (excluding mitochondrial chromosomes). mitoRate : the decimal fraction of reads which mapped to the mitochondrial chromosome, of those which map at all (i.e. mitoMapped / (totalMapped + mitoMapped)) totalAssignedGene : the decimal fraction of reads assigned unambiguously to a gene (including mitochondrial genes), with featureCounts (Liao et al. 2014), of those in total. rRNA_rate : the decimal fraction of reads assigned to a gene whose type is ‘rRNA’, of those assigned to any gene. Tissue : tissue (mouse brain or blood) from which the sample comes. Age : if the sample comes from an adult or a pup mouse. Sex : if the sample comes from a female (F) or male (M) mouse. Expt : the experiment (nicotine or smoking exposure) to which the sample mouse was subjected; it could be an exposed or a control mouse of that experiment. Group : if the sample belongs to a nicotine/smoking-exposed mouse (Expt) or a nicotine/smoking control mouse (Ctrl). plate : is the plate (1,2 or 3) in which the sample library was prepared. Pregnancy : if the sample comes from a pregnant (Yes) or not pregnant (No) mouse. medium : is the medium in which the sample was treated: water for brain samples and an elution buffer (EB) for the blood ones. flowcell : is the sequencing batch of each sample. sum : library size (total sum of counts across all genes for each sample). detected : number of non-zero expressed genes in each sample. subsets_Mito_sum : total sum of read counts of mt genes in each sample. subsets_Mito_detected : total number of mt genes in each sample. subsets_Mito_percent : % of mt genes’ counts of the total counts of the sample. subsets_Ribo_sum : total sum of read counts of ribosomal genes in each sample. subsets_Ribo_detected : total number of ribosomal genes in each sample. subsets_Ribo_percent : % of ribosomal genes’ counts of the total counts of the sample. Note: in our case, we’ll use samples from the nicotine experiment only, so all samples come from brain and were treated in water. ## Data for first 3 samples and 5 variables colData(rse_gene)[1:3, 1:5] #&gt; DataFrame with 3 rows and 5 columns #&gt; SAMPLE_ID FQCbasicStats perBaseQual perTileQual perSeqQual #&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt; #&gt; 1 Sample_2914 PASS PASS PASS PASS #&gt; 2 Sample_4042 PASS PASS PASS PASS #&gt; 3 Sample_4043 PASS PASS PASS PASS 4.2.3 Gene Information Among the information in rowData(RSE) the next variables are of interest for the analysis: gencodeID : GENCODE ID of each gene. ensemblID : gene ID in Ensembl database. EntrezID : identifier of each gene in NCBI Entrez database. Symbol : official gene symbol for each mouse gene. retained_after_feature_filtering : Boolean variable that equals TRUE if the gene passed the gene filtering (with filterByExpr() of edgeR) based on its expression levels and FALSE if not. DE_in_adult_brain_nicotine : Boolean variable that equals TRUE if the feature is differentially expressed (DE) in adult brain samples exposed to nicotine and FALSE if not. DE_in_pup_brain_nicotine : Boolean variable that equals TRUE if the feature is differentially expressed (DE) in pup brain samples exposed to nicotine and FALSE if not. ## Data for first 3 genes and 5 variables rowData(rse_gene)[1:3, 1:5] #&gt; DataFrame with 3 rows and 5 columns #&gt; Length gencodeID ensemblID gene_type EntrezID #&gt; &lt;integer&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt; #&gt; ENSMUSG00000102693.1 1070 ENSMUSG00000102693.1 ENSMUSG00000102693 TEC 71042 #&gt; ENSMUSG00000064842.1 110 ENSMUSG00000064842.1 ENSMUSG00000064842 snRNA NA #&gt; ENSMUSG00000051951.5 6094 ENSMUSG00000051951.5 ENSMUSG00000051951 protein_coding 497097 p.exercise { background-color: #DBDBDB; padding: 10px; border: 1px solid black; margin-left: 25px; border-radius: 5px; font-family: sans-serif; } ❓ How would you access data of a specific column? For illustrative purposes, we’ll use nicotine data at the gene level only so let’s access that data. ## Original dimensions of the data rse_gene_nic &lt;- rse_gene[,which(rse_gene$Expt==&#39;Nicotine&#39;)] ## New dimensions dim(rse_gene_nic) #&gt; [1] 55401 65 "],["isee-introduction.html", "5 iSEE introduction", " 5 iSEE introduction Instructor: Leo "],["rse-plotting-basics-with-smokingmouse.html", "6 RSE plotting basics with smokingMouse", " 6 RSE plotting basics with smokingMouse Instructor: Daianna We will download the rse_gene object which contains the data at the gene level. We’ll use BiocFileCache to keep the data in a local cache in case we want to run this example again and don’t want to re-download the data from the web. ## Download and cache the file library(&quot;BiocFileCache&quot;) bfc &lt;- BiocFileCache::BiocFileCache() cached_rse_gene &lt;- BiocFileCache::bfcrpath( x = bfc, &quot;https://github.com/LieberInstitute/SPEAQeasyWorkshop2023/raw/devel/provisional_data/rse_gene_mouse_RNAseq_nic-smo.Rdata&quot; ) ## Check the local path on our cache cached_rse_gene #&gt; BFC1 #&gt; &quot;/github/home/.cache/R/BiocFileCache/4c43245269d_rse_gene_mouse_RNAseq_nic-smo.Rdata&quot; ## Load the rse_gene object load(cached_rse_gene, verbose = TRUE) #&gt; Loading objects: #&gt; rse_gene ## General overview of the object rse_gene #&gt; class: RangedSummarizedExperiment #&gt; dim: 55401 208 #&gt; metadata(1): Obtained_from #&gt; assays(2): counts logcounts #&gt; rownames(55401): ENSMUSG00000102693.1 ENSMUSG00000064842.1 ... ENSMUSG00000064371.1 ENSMUSG00000064372.1 #&gt; rowData names(13): Length gencodeID ... DE_in_pup_brain_nicotine DE_in_pup_brain_smoking #&gt; colnames: NULL #&gt; colData names(71): SAMPLE_ID FQCbasicStats ... retained_after_QC_sample_filtering #&gt; retained_after_manual_sample_filtering "],["biocthis-introduction.html", "7 biocthis introduction", " 7 biocthis introduction Instructor: Leo "],["recount3-introduction.html", "8 recount3 introduction", " 8 recount3 introduction Instructor: Leo "],["interpreting-model-coefficients-with-exploremodelmatrix.html", "9 Interpreting model coefficients with ExploreModelMatrix", " 9 Interpreting model coefficients with ExploreModelMatrix Instructor: Leo "],["differential-gene-expression-analysis-with-limma.html", "10 Differential gene expression analysis with limma", " 10 Differential gene expression analysis with limma Instructor: Leo "],["differential-gene-expression-exercise-with-recount3-data.html", "11 Differential gene expression exercise with recount3 data", " 11 Differential gene expression exercise with recount3 data Instructor: Leo "],["de-model-building-with-variancepartition.html", "12 DE model building with variancePartition", " 12 DE model building with variancePartition Instructor: Daianna "],["expression-heatmaps-with-complexheatmap.html", "13 Expression heatmaps with ComplexHeatmap", " 13 Expression heatmaps with ComplexHeatmap Instructor: Renee "],["exercise-with-variancepartition-and-complexheatmap.html", "14 Exercise with variancePartition and ComplexHeatmap", " 14 Exercise with variancePartition and ComplexHeatmap Instructors: Daianna and Renee "],["tbd.html", "15 TBD", " 15 TBD Instructor: Leo "],["introduction-to-the-world-of-spatially-resolved-transcriptomics-with-visium-data.html", "16 Introduction to the world of spatially-resolved transcriptomics with Visium data", " 16 Introduction to the world of spatially-resolved transcriptomics with Visium data SingleCellExperiment –&gt; SpatialExperiment –&gt; spatialLIBD Instructor: Leo "],["downloading-public-visium-spatial-data-and-visualizing-it-with-spatiallibd.html", "17 Downloading public Visium spatial data and visualizing it with spatialLIBD", " 17 Downloading public Visium spatial data and visualizing it with spatialLIBD Instructor: Leo "],["re-use-of-bulk-rna-seq-methods-for-spatial-data-exercise.html", "18 Re-use of bulk RNA-seq methods for spatial data exercise", " 18 Re-use of bulk RNA-seq methods for spatial data exercise Instructor: Leo "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
